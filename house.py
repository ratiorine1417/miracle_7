import streamlit as st
import pandas as pd
# ìƒ˜í”Œ ë§¤ë¬¼ ë°ì´í„° (ì‹¤ì œ API ì—°ë™ í•„ìš”)
df = pd.DataFrame({
    'ì§€ì—­': ['ì„œìš¸ ê°•ë‚¨', 'ì„œìš¸ ë§ˆí¬', 'ì„œìš¸ ì†¡íŒŒ'],
    'ê°€ê²©': [80000, 55000, 72000],
    'ë©´ì ': [30, 20, 25],
    'ìœ„ë„': [37.4979, 37.5407, 37.5065],
    'ê²½ë„': [127.0276, 126.9469, 127.1060],
    'ì£¼ì†Œ': ['ê°•ë‚¨ì—­ ê·¼ì²˜', 'í™ëŒ€ì…êµ¬ì—­ ê·¼ì²˜', 'ì ì‹¤ì—­ ê·¼ì²˜'],
    'ì¸µ': [10, 5, 7],
    'ë°©ìˆ˜': [2, 1, 3],
    'ì—˜ë¦¬ë² ì´í„°': ['ìˆìŒ', 'ì—†ìŒ', 'ìˆìŒ'],
    'ë‚œë°©': ['ì¤‘ì•™ë‚œë°©', 'ê°œë³„ë‚œë°©', 'ì§€ì—­ë‚œë°©']
})

# ---------------------
# 1. ëŒ€ì‹œë³´ë“œ UI êµ¬ì„±
# ---------------------
st.set_page_config(page_title="ë¶€ë™ì‚° ëŒ€ì‹œë³´ë“œ", layout="wide")

st.title("ğŸ¡ 7ë²ˆë°©ì˜ ê¸°ì ")
st.sidebar.header("ğŸ” í•„í„°ë§ ê²€ìƒ‰")

# í•„í„° ì˜µì…˜
ì§€ì—­ì˜µì…˜ = st.sidebar.multiselect("ì§€ì—­ ì„ íƒ", options=df['ì§€ì—­'].unique(), default=df['ì§€ì—­'].unique())
ê°€ê²©ë²”ìœ„ = st.sidebar.slider("ê°€ê²© ë²”ìœ„ (ë§Œì›)", min_value=0, max_value=100000, value=(0, 100000))
ë©´ì ë²”ìœ„ = st.sidebar.slider("ë©´ì  ë²”ìœ„ (ã¡)", min_value=10, max_value=60, value=(10, 60))

# í•„í„°ë§ ì ìš©
filtered_df = df[
    df['ì§€ì—­'].isin(ì§€ì—­ì˜µì…˜) &
    df['ê°€ê²©'].between(ê°€ê²©ë²”ìœ„[0], ê°€ê²©ë²”ìœ„[1]) &
    df['ë©´ì '].between(ë©´ì ë²”ìœ„[0], ë©´ì ë²”ìœ„[1])
]


# ---------------------
# 2. ì§€ë„ ê¸°ë°˜ ì‹œê°í™”
# ---------------------
st.subheader("ğŸ—ºï¸ ì§€ë„ ê¸°ë°˜ ë§¤ë¬¼ ì‹œê°í™”")


st.markdown("""
<div style='
    border: 2px dashed #999;
    height: 400px;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f9f9f9;
    font-size: 20px;
    font-weight: bold;
    color: #555;
'>
ì§€ë„ ê¸°ë°˜ ë§¤ë¬¼ ì‹œê°í™” ì˜ì—­ (ì¶”í›„ KakaoMap ì‚½ì… ì˜ˆì •)
</div>
""", unsafe_allow_html=True)


# st.subheader("ğŸ—ºï¸ ì§€ë„ ê¸°ë°˜ ë§¤ë¬¼ ì‹œê°í™”")
# m = folium.Map(location=[37.5, 127], zoom_start=11)

# for i, row in filtered_df.iterrows():
#     popup_text = f"{row['ì§€ì—­']}<br>{row['ê°€ê²©']}ë§Œì›<br>{row['ì£¼ì†Œ']}"
#     folium.Marker([row['ìœ„ë„'], row['ê²½ë„']], popup=popup_text).add_to(m)

# st_data = st_folium(m, width=700, height=500)

# ---------------------
# 3. ë§¤ë¬¼ ë¦¬ìŠ¤íŠ¸ ë° ì •ë ¬
# ---------------------
st.subheader("ğŸ“‹ ë§¤ë¬¼ ë¦¬ìŠ¤íŠ¸")

ì •ë ¬ê¸°ì¤€ = st.selectbox("ì •ë ¬ ê¸°ì¤€", ['ê°€ê²©', 'ë©´ì '])
ì •ë ¬ë°©ì‹ = st.radio("ì •ë ¬ ë°©ì‹", ['ì˜¤ë¦„ì°¨ìˆœ', 'ë‚´ë¦¼ì°¨ìˆœ'])

ascending = True if ì •ë ¬ë°©ì‹ == 'ì˜¤ë¦„ì°¨ìˆœ' else False
sorted_df = filtered_df.sort_values(by=ì •ë ¬ê¸°ì¤€, ascending=ascending)

st.dataframe(sorted_df[['ì§€ì—­', 'ê°€ê²©', 'ë©´ì ', 'ì£¼ì†Œ']])

# ---------------------
# 4. ë§¤ë¬¼ ìƒì„¸ ì •ë³´ ëª¨ë‹¬ êµ¬ì„± (ì˜ˆì‹œ)
# ---------------------
st.subheader("ğŸ  ë§¤ë¬¼ ìƒì„¸ ë³´ê¸°")

ì„ íƒë§¤ë¬¼ = st.selectbox("ë§¤ë¬¼ ì„ íƒ", sorted_df['ì£¼ì†Œ'].tolist())
ë§¤ë¬¼ì •ë³´ = sorted_df[sorted_df['ì£¼ì†Œ'] == ì„ íƒë§¤ë¬¼].iloc[0]

with st.expander(f"{ë§¤ë¬¼ì •ë³´['ì£¼ì†Œ']} ìƒì„¸ ì •ë³´ ë³´ê¸°"):
    st.write(f"ğŸ“ ìœ„ì¹˜: {ë§¤ë¬¼ì •ë³´['ì§€ì—­']} - {ë§¤ë¬¼ì •ë³´['ì£¼ì†Œ']}")
    st.write(f"ğŸ’° ê°€ê²©: {ë§¤ë¬¼ì •ë³´['ê°€ê²©']}ë§Œì›")
    st.write(f"ğŸ“ ë©´ì : {ë§¤ë¬¼ì •ë³´['ë©´ì ']}ã¡")
    st.write(f"ğŸšª ë°©ìˆ˜: {ë§¤ë¬¼ì •ë³´['ë°©ìˆ˜']} / ì¸µìˆ˜: {ë§¤ë¬¼ì •ë³´['ì¸µ']}")
    st.write(f"ğŸ”¥ ë‚œë°©: {ë§¤ë¬¼ì •ë³´['ë‚œë°©']} / ğŸ›— ì—˜ë¦¬ë² ì´í„°: {ë§¤ë¬¼ì •ë³´['ì—˜ë¦¬ë² ì´í„°']}")
    st.image("https://via.placeholder.com/300x200.png?text=ë§¤ë¬¼+ì´ë¯¸ì§€", caption="ìƒ˜í”Œ ì´ë¯¸ì§€")
    st.write("ğŸ“ ì£¼ë³€ ê³µì¸ì¤‘ê°œì‚¬: 02-1234-5678")

# ---------------------
# 5. ì‚¬ìš©ì ë§ì¶¤í˜• ìš”ì•½ ì •ë³´ ë°°ì¹˜
# ---------------------
st.sidebar.subheader("ğŸš€ ìš”ì•½ ì •ë³´")
st.sidebar.write(f"í•„í„°ë§ ê²°ê³¼ ë§¤ë¬¼ ìˆ˜: {len(filtered_df)}ê±´")
st.sidebar.write(f"ìµœì €ê°€: {filtered_df['ê°€ê²©'].min()}ë§Œì› / ìµœê³ ê°€: {filtered_df['ê°€ê²©'].max()}ë§Œì›")
